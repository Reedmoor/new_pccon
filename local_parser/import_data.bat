@echo off
chcp 65001 >nul
echo ====================================================
echo        –ò–ú–ü–û–†–¢ –î–ê–ù–ù–´–• –ù–ê –°–ï–†–í–ï–†
echo ====================================================
echo.

cd /d "%~dp0"

REM –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É Python
call get_python.bat
echo üêç –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Python: %PYTHON_CMD%
echo.

echo –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∏–º–ø–æ—Ä—Ç–∞:
echo.
echo 1. –ò–º–ø–æ—Ä—Ç –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (local_data/*.json ‚Üí –≤–µ–±-—Å–µ—Ä–≤–µ—Ä 5000)
echo 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞ 5001 –Ω–∞ Docker 5000
echo 3. –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞ (–∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
echo 4. –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –ø–∞—Ä—Å–∏–Ω–≥ ‚Üí –≤–µ–±-—Å–µ—Ä–≤–µ—Ä 5000
echo.
echo 0. ‚ùå –í—ã—Ö–æ–¥
echo.

set /p choice="–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º (0-4): "

if "%choice%"=="1" goto import_local
if "%choice%"=="2" goto sync_servers  
if "%choice%"=="3" goto export_hosting
if "%choice%"=="4" goto full_cycle
if "%choice%"=="0" goto exit

echo.
echo ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!
pause
goto menu

:import_local
cls
echo ====================================================
echo üìÇ –ò–º–ø–æ—Ä—Ç –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä 5000...
echo ====================================================
echo.

echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–∞–π–ª–æ–≤ –¥–∞–Ω–Ω—ã—Ö...
echo.

REM –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
"%PYTHON_CMD%" upload_to_docker.py --server-url http://127.0.0.1:5000

if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞!
    pause
    exit /b 1
)

echo.
echo ‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!
goto sync_to_docker

:sync_servers
echo üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤ 5001 ‚Üí 5000...
call sync_5001_to_5000_docker.bat
echo.
echo ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
echo.
pause
exit /b 0

:export_hosting
cls
echo ====================================================
echo üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞...
echo ====================================================
echo.

"%PYTHON_CMD%" upload_existing_data.py --export-only

echo.
echo ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!
pause
exit /b 0

:full_cycle
cls
echo ====================================================
echo üîÑ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –ø–∞—Ä—Å–∏–Ω–≥ + –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä 5000...
echo ====================================================
echo.

echo –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞:
echo.
echo 1. –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã (processor)
echo 2. –í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã (graphics_card)  
echo 3. –ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã (motherboard)
echo 4. –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å (ram)
echo 5. SSD/HDD (hard_drive)
echo 6. –ë–ª–æ–∫–∏ –ø–∏—Ç–∞–Ω–∏—è (power_supply)
echo 7. –ö–æ—Ä–ø—É—Å–∞ (case)
echo 8. –ö—É–ª–µ—Ä—ã (cooler)
echo.

set /p cat_choice="–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é (1-8): "

echo.
set /p limit_choice="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20): "
if "%limit_choice%"=="" set limit_choice=20

echo.
echo üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—Å–∏–Ω–≥–∞:
echo    –ö–∞—Ç–µ–≥–æ—Ä–∏—è: %cat_choice%
echo    –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %limit_choice%
echo    –°–µ—Ä–≤–µ—Ä: http://127.0.0.1:5000 (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
echo.

set /p confirm="–ù–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥? (y/n): "
if /i not "%confirm%"=="y" (
    echo –û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞
    pause
    exit /b 0
)

echo.
echo üöÄ –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞...
echo.

REM –ó–∞–ø—É—Å–∫–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
"%PYTHON_CMD%" local_dns_parser.py --category %cat_choice% --limit %limit_choice% --server-url http://127.0.0.1:5000

if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞!
    pause
    exit /b 1
)

echo.
echo üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä...
"%PYTHON_CMD%" upload_to_docker.py --server-url http://127.0.0.1:5000

if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏!
    pause
    exit /b 1
)

echo.
echo ‚úÖ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
echo.
echo üí° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–Ω–æ:
echo    ‚Ä¢ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Docker: http://127.0.0.1:5000
echo.
pause
exit /b 0

:sync_to_docker
echo.
echo üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Docker —Å–µ—Ä–≤–µ—Ä–æ–º...
call sync_5001_to_5000_docker.bat

:exit
echo.
echo üëã –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!
pause
exit /b 0 