@echo off
chcp 65001 >nul

REM –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ (–±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)

cd /d "%~dp0"

REM –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É Python
call get_python.bat

REM –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 5000)
set server_url=http://127.0.0.1:5000
set data_file=..\app\utils\old_dns_parser\product_data.json

echo ====================================================
echo      –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–•
echo ====================================================
echo üéØ –¶–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä: %server_url%
echo üìÅ –§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö: %data_file%
echo.

if not exist "%data_file%" (
    echo ‚ùå –§–∞–π–ª product_data.json –Ω–µ –Ω–∞–π–¥–µ–Ω!
    exit /b 1
)

echo üöÄ –ó–∞–ø—É—Å–∫ –∑–∞–≥—Ä—É–∑–∫–∏...

REM –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (5000) –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç API
"%PYTHON_CMD%" upload_single_file.py --server-url %server_url% --data-file "%data_file%"

if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏!
    exit /b 1
)

echo ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
echo üí° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: %server_url%
exit /b 0 